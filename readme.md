# Тестовое задание

## Описание задания

Дан видеофайл `crowd.mp4`. Нужно написать программу на языке Python, которая будет выполнять детекцию людей и их отрисовку на этом видео, проанализировать результат и сформировать рекомендации по дальнейшему улучшению. 
___
## Структура проекта

- `main.py` - Главный скрипт/точка входа
- `detection.py` - Модуль с классом `PeopleDetector` для детекции 
- `drawing_bb.py` - Модуль с функцией `draw_predictions` для отрисовки bb
- `requirements.txt` - Файл с зависимостями 
- `BASELINE.ipynb` - Ноутбук с базовым пайплайном и пояснениями и первичными выводами
___
## HOW TO USE
### script
pip install -r requirements.txt
python main.py
При необходимости изменение переменных SOURCE_PATH, THRESHOLD и дефолтного значения параметра SAVE_PATH функии main
### ipynb
См. BASELINE.ipynb c пояснениями и базовым пайплайном
___
## Результаты
### Исходное видео
![Original Video](original_video.gif)
___
### Обработанное видео
![Processed Video](detect_video.gif)
___
## Анализ полученных результатов
- при выбранном трешхолде в 0.9 модель детектирует людей только на переднем плане
- модель принимает за человека зонт и раскладное кресло на переднем фоне с вероятностью > 90% хотя и прописывает им правильные классы
- модель теряет людей при заходе друг за друга
- модель переодичкески накладывает рамки друг на друга
- при снижении трешхолда score до 50% процентов модель начинает различать маленьких людей и людей на заднем плане, но также принимает бОльше объектов за людей которыми таковыми не являются
___
## Рекомендации по улучшению модели:
- в зависимости от конкретной задачи лучшие результаты могут показать SOTA (и не только) модели. Например YOLO v5/v8, DETR и т.д.
- всё так же в зависимости от важности детектирования людей на заднем плане можно подобрать оптимальный трешхолд для score на отрисовку
- обработать случаи когда модель пишет, что объект человек, хотя argmax для объекта другой класс
- дообучить/обучить с нуля модель в зависимости от возможности/необходимости/целесообразности
- накинуть постобработку NMS для избегания накладывания рамок внутри одного объекта 
