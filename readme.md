# Тестовое задание

## Описание задания

Дан видеофайл `crowd.mp4`. Нужно написать программу на языке Python, которая будет выполнять детекцию людей и их отрисовку на этом видео, проанализировать результат и сформировать рекомендации по дальнейшему улучшению. 
___
## Структура проекта
project/
│
├── src/
│ ├── init.py
│ ├── main.py - Главный скрипт/точка входа
│ ├── detection.py - Модуль с классом `PeopleDetector` для детекции 
│ ├── drawing_bb.py - Модуль с функцией `draw_predictions` для отрисовки bb
│
├── notebooks/
│ ├── baseline.ipynb - Ноутбук с базовым пайплайном и пояснениями и первичными выводами
│
├── data/
│ ├── crowd.mp4 - Исходное видео
│
├── output/
│ ├── output_crowd.mp4
│ ├── demo1.gif
│ ├── demo2.gif
│
├── requirements.txt - Файл с зависимостями 
├── README.md

___
## Как использовать

Для использования этого проекта, выполните следующие шаги:

1. Установите необходимые зависимости, выполнив команду:
    ```bash
    pip install -r requirements.txt
    ```

2. Запустите обработку видео, используя следующую команду:
    ```bash
    python src/main.py --input_folder data --output_folder output --threshold 0.5
    ```

    Опции:
    - `--input_folder`: Папка, содержащая входные видеофайлы (по умолчанию: `data`).
    - `--output_folder`: Папка для сохранения обработанных видеофайлов (по умолчанию: `output`).
    - `--threshold`: Пороговое значение для уверенности детекции (по умолчанию: `0.5`).

## Демонстрация

Ниже приведены примеры работы алгоритма:

![Demo 1](output/demo1.gif)
![Demo 2](output/demo2.gif)
___
## Анализ полученных результатов
- при выбранном трешхолде в 0.9 модель детектирует людей только на переднем плане
- модель принимает за человека зонт и раскладное кресло на переднем фоне с вероятностью > 90% хотя и прописывает им правильные классы
- модель теряет людей при заходе друг за друга
- модель периодически накладывает рамки друг на друга
- при снижении трешхолда score до 50% процентов модель начинает различать маленьких людей и людей на заднем плане, но также принимает бОльше объектов за людей которыми таковыми не являются
___
## Рекомендации по улучшению модели:
- в зависимости от конкретной задачи лучшие результаты могут показать SOTA (и не только) модели. Например YOLO v5/v8, DETR и т.д.
- всё так же в зависимости от важности детектирования людей на заднем плане можно подобрать оптимальный трешхолд для score на отрисовку
- обработать случаи когда модель пишет, что объект человек, хотя argmax для объекта другой класс
- дообучить/обучить с нуля модель в зависимости от возможности/необходимости/целесообразности
- накинуть постобработку NMS для избегания накладывания рамок внутри одного объекта 
